var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _objectSpread2=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _propTypes=require("prop-types");var _react=require("react");var _reactNative=require("react-native");var _common=require("../../common");var _modules=require("./modules");var IS_TEST=_common.ENV.IS_TEST,IS_WEB=_common.ENV.IS_WEB;var MOTION=_common.THEME.MOTION;var Motion=function(_PureComponent){(0,_inherits2.default)(Motion,_PureComponent);function Motion(props){var _this;(0,_classCallCheck2.default)(this,Motion);_this=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(Motion).call(this,props));var preset=props.preset,_props$timeline=props.timeline,timeline=_props$timeline===void 0?[]:_props$timeline,useNativeDriver=props.useNativeDriver,visible=props.visible;var state={timeline:timeline};if(preset)state.timeline=(0,_modules.presetVisibility)(preset,visible);if(!useNativeDriver){state.timeline.forEach(function(_ref){var property=_ref.property,value=_ref.value;state[property]=new _reactNative.Animated.Value(value);});}_this.state=(0,_objectSpread2.default)({},state);return _this;}(0,_createClass2.default)(Motion,[{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var props=this.props,_this$state=this.state,state=_this$state===void 0?{}:_this$state;var _props$nextProps=(0,_objectSpread2.default)({},props,nextProps),delay=_props$nextProps.delay,disabled=_props$nextProps.disabled,duration=_props$nextProps.duration,preset=_props$nextProps.preset,_props$nextProps$time=_props$nextProps.timeline,timeline=_props$nextProps$time===void 0?[]:_props$nextProps$time,type=_props$nextProps.type,useNativeDriver=_props$nextProps.useNativeDriver,visible=_props$nextProps.visible;state.timeline=timeline;if(preset){state.timeline=(0,_modules.presetVisibility)(preset,visible);this.setState(state);}if(IS_TEST||disabled||useNativeDriver)return;var animatedProps={delay:delay,duration:duration,useNativeDriver:true};var motions=state.timeline.map(function(_ref2){var property=_ref2.property,toValue=_ref2.value;return _reactNative.Animated[type](state[property],(0,_objectSpread2.default)({toValue:toValue},animatedProps)).start();});_reactNative.Animated.parallel(motions).start();}},{key:"render",value:function render(){var _this$props=this.props,children=_this$props.children,disabled=_this$props.disabled,useNativeDriver=_this$props.useNativeDriver,inherit=(0,_objectWithoutProperties2.default)(_this$props,["children","disabled","useNativeDriver"]);var props={style:[inherit.style,!disabled&&(0,_modules.buildStyle)(this)]};if(inherit.pointerEvents)props.pointerEvents=inherit.pointerEvents;return(0,_react.createElement)(!disabled&&useNativeDriver?_reactNative.View:_reactNative.Animated.View,props,children);}}]);return Motion;}(_react.PureComponent);Motion.propTypes={children:_propTypes.node,delay:_propTypes.number,disabled:_propTypes.bool,duration:_propTypes.number,preset:(0,_propTypes.oneOf)(['fade','fadeleft','pop']),timeline:(0,_propTypes.arrayOf)((0,_propTypes.shape)(_common.SHAPE.MOTION)),type:_propTypes.string,useNativeDriver:_propTypes.bool,visible:_propTypes.bool};Motion.defaultProps={children:undefined,delay:0,disabled:false,duration:MOTION.DURATION,preset:undefined,timeline:undefined,type:'timing',useNativeDriver:IS_WEB,visible:false};var _default=Motion;exports.default=_default;