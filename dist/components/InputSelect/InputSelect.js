var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _propTypes=require("prop-types");var _react=_interopRequireWildcard(require("react"));var _reactDom=require("react-dom");var _reactNative=require("react-native");var _common=require("../../common");var _Button=_interopRequireDefault(require("../Button"));var _Input=require("../Input");var _Motion=_interopRequireDefault(require("../Motion"));var _Touchable=_interopRequireDefault(require("../Touchable"));var _Input2=require("../Input/Input.style");var _InputSelectTemplate=_interopRequireDefault(require("./InputSelectTemplate"));var _InputSelectTemplate2=require("./InputSelectTemplate.style");var _InputSelect=_interopRequireDefault(require("./InputSelect.style"));var _jsxFileName="/Users/soyjavi/git/minube/reactor/components/InputSelect/InputSelect.js";var COLOR=_common.THEME.COLOR;var InputSelect=function(_PureComponent){(0,_inherits2.default)(InputSelect,_PureComponent);function InputSelect(props){var _this;(0,_classCallCheck2.default)(this,InputSelect);_this=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(InputSelect).call(this,props));_this._onToggleDataSource=function(){var _assertThisInitialize=(0,_assertThisInitialized2.default)(_this),component=_assertThisInitialize.component,scrollview=_assertThisInitialize.scrollview,_assertThisInitialize2=_assertThisInitialize.props,dataSource=_assertThisInitialize2.dataSource,_assertThisInitialize3=_assertThisInitialize2.value,value=_assertThisInitialize3===void 0?0:_assertThisInitialize3,active=_assertThisInitialize.state.active;var H=_common.LAYOUT.VIEWPORT.H;var _findDOMNode$getBound=(0,_reactDom.findDOMNode)(component.current).getBoundingClientRect(),y=_findDOMNode$getBound.y;_this.setState({active:!active,regular:y<H/2},function(){if(!active){var height=dataSource[0].caption?_InputSelectTemplate2.TEMPLATE_HEIGHT:_Input2.INPUT_HEIGHT;scrollview.current.scrollTo({y:(value-2)*height,animated:false});}});};_this._onItem=function(index){var _assertThisInitialize4=(0,_assertThisInitialized2.default)(_this),_onToggleDataSource=_assertThisInitialize4._onToggleDataSource,onChange=_assertThisInitialize4.props.onChange;_onToggleDataSource();if(onChange)onChange(index);};var _props$dataSource=props.dataSource;_props$dataSource=_props$dataSource===void 0?[]:_props$dataSource;var _props$dataSource2=(0,_slicedToArray2.default)(_props$dataSource,1),firstValue=_props$dataSource2[0];_this.component=(0,_react.createRef)();_this.scrollview=(0,_react.createRef)();_this.state={active:false,regular:true,schema:typeof firstValue==='object'};return _this;}(0,_createClass2.default)(InputSelect,[{key:"render",value:function render(){var _onToggleDataSource=this._onToggleDataSource,_onItem=this._onItem,_this$props=this.props,_this$props$dataSourc=_this$props.dataSource,dataSource=_this$props$dataSourc===void 0?[]:_this$props$dataSourc,disabled=_this$props.disabled,error=_this$props.error,hint=_this$props.hint,label=_this$props.label,onChange=_this$props.onChange,ItemTemplate=_this$props.ItemTemplate,_this$props$value=_this$props.value,value=_this$props$value===void 0?0:_this$props$value,inherit=(0,_objectWithoutProperties2.default)(_this$props,["dataSource","disabled","error","hint","label","onChange","ItemTemplate","value"]),_this$state=this.state,active=_this$state.active,regular=_this$state.regular,schema=_this$state.schema;var hasDataSource=dataSource.length>1;var event=!disabled&&hasDataSource?_onToggleDataSource:undefined;return _react.default.createElement(_reactNative.View,{ref:this.component,style:[_InputSelect.default.container,active&&_InputSelect.default.active,inherit.style],__source:{fileName:_jsxFileName,lineNumber:86}},label&&_react.default.createElement(_Input.InputLabel,{error:error,__source:{fileName:_jsxFileName,lineNumber:88}},label),schema&&hasDataSource&&!disabled&&_react.default.createElement(_Motion.default,{style:[_InputSelect.default.button,label&&_InputSelect.default.withLabel],timeline:[{property:'rotate',value:active?'180deg':'0deg'}],__source:{fileName:_jsxFileName,lineNumber:93}},_react.default.createElement(_Button.default,{contained:false,icon:"expand",onPress:event,__source:{fileName:_jsxFileName,lineNumber:97}})),_react.default.createElement(_reactNative.View,{style:[_InputSelect.default.border,!disabled&&error&&_InputSelect.default.error,disabled&&_InputSelect.default.disabled],__source:{fileName:_jsxFileName,lineNumber:100}},schema?_react.default.createElement(_Touchable.default,{onPress:event,rippleColor:COLOR.PRIMARY,__source:{fileName:_jsxFileName,lineNumber:103}},_react.default.createElement(ItemTemplate,(0,_extends2.default)({},dataSource[value],{disabled:disabled,active:true,style:_InputSelect.default.template,__source:{fileName:_jsxFileName,lineNumber:104}}))):_react.default.createElement(_reactNative.Picker,(0,_extends2.default)({mode:"dropdown"},inherit,{enabled:!disabled,onValueChange:onChange,selectedValue:value,style:[_InputSelect.default.picker,disabled&&_InputSelect.default.pickerDisabled],__source:{fileName:_jsxFileName,lineNumber:107}}),dataSource.map(function(item){return _react.default.createElement(_reactNative.Picker.Item,{key:item,label:item,value:item,style:_InputSelect.default.pickerItem,__source:{fileName:_jsxFileName,lineNumber:116}});}))),hint&&_react.default.createElement(_Input.InputHint,{__source:{fileName:_jsxFileName,lineNumber:121}},hint),schema&&_react.default.createElement(_reactNative.ScrollView,{ref:this.scrollview,style:[_InputSelect.default.border,_InputSelect.default.dataSource,!active&&_InputSelect.default.dataSourceHidden,!regular&&_InputSelect.default.dataSourceBottom,label&&_InputSelect.default.withLabel],__source:{fileName:_jsxFileName,lineNumber:126}},dataSource.map(function(item,index){return _react.default.createElement(_Touchable.default,{key:item.title,onPress:function onPress(){return _onItem(index);},rippleColor:COLOR.PRIMARY,__source:{fileName:_jsxFileName,lineNumber:137}},_react.default.createElement(ItemTemplate,(0,_extends2.default)({},item,{selected:index===value,style:_InputSelect.default.template,__source:{fileName:_jsxFileName,lineNumber:138}})));})));}}]);return InputSelect;}(_react.PureComponent);InputSelect.propTypes={dataSource:(0,_propTypes.arrayOf)((0,_propTypes.oneOfType)([_propTypes.string,(0,_propTypes.shape)({})])),disabled:_propTypes.bool,error:_propTypes.string,hint:_propTypes.string,label:_propTypes.string,onChange:_propTypes.func,ItemTemplate:_propTypes.func,value:(0,_propTypes.oneOfType)([_propTypes.string,_propTypes.number])};InputSelect.defaultProps={dataSource:[],disabled:false,error:undefined,hint:undefined,label:undefined,onChange:undefined,ItemTemplate:_InputSelectTemplate.default,value:0};var _default=InputSelect;exports.default=_default;