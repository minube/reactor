var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf3=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _propTypes=require("prop-types");var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _Icon=_interopRequireDefault(require("../Icon"));var _Input=_interopRequireDefault(require("../Input"));var _Touchable=_interopRequireDefault(require("../Touchable"));var _ItemList=_interopRequireDefault(require("./components/ItemList"));var _filterDataSource=_interopRequireDefault(require("./modules/filterDataSource"));var _InputList=_interopRequireDefault(require("./InputList.style"));var _jsxFileName="/Users/soyjavi/git/minube/reactor/components/InputList/InputList.js";var InputList=function(_PureComponent){(0,_inherits2.default)(InputList,_PureComponent);function InputList(){var _getPrototypeOf2;var _this;(0,_classCallCheck2.default)(this,InputList);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=(0,_possibleConstructorReturn2.default)(this,(_getPrototypeOf2=(0,_getPrototypeOf3.default)(InputList)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={inputValue:undefined,suggestions:[]};_this._onInputChange=function(inputValue){var _assertThisInitialize=(0,_assertThisInitialized2.default)(_this),_assertThisInitialize2=_assertThisInitialize.props,dataSource=_assertThisInitialize2.dataSource,dataSourceField=_assertThisInitialize2.dataSourceField,value=_assertThisInitialize2.value;_this.setState({inputValue:inputValue,suggestions:dataSource&&inputValue?(0,_filterDataSource.default)(dataSource,inputValue,value,dataSourceField):[]});};_this._onInputSubmit=function(){var _assertThisInitialize3=(0,_assertThisInitialized2.default)(_this),_onChange=_assertThisInitialize3._onChange,_assertThisInitialize4=_assertThisInitialize3.props,dataSource=_assertThisInitialize4.dataSource,dataSourceField=_assertThisInitialize4.dataSourceField,_assertThisInitialize5=_assertThisInitialize3.state,inputValue=_assertThisInitialize5.inputValue,suggestions=_assertThisInitialize5.suggestions;if(suggestions.length===1||!dataSource&&inputValue){var suggestion=suggestions[0];var newItem=(typeof suggestion==='object'?suggestion[dataSourceField]:suggestion)||inputValue;_onChange(newItem);}};_this._onSelectItem=function(item){var _assertThisInitialize6=(0,_assertThisInitialized2.default)(_this),_onChange=_assertThisInitialize6._onChange,dataSourceField=_assertThisInitialize6.props.dataSourceField;var newItem=typeof item==='object'&&dataSourceField?item[dataSourceField]:item;_onChange(newItem);};_this._onRemoveItem=function(item){var _assertThisInitialize7=(0,_assertThisInitialized2.default)(_this),_assertThisInitialize8=_assertThisInitialize7.props,onChange=_assertThisInitialize8.onChange,_assertThisInitialize9=_assertThisInitialize8.value,value=_assertThisInitialize9===void 0?[]:_assertThisInitialize9;var newValue=value.filter(function(i){return i!==item;});onChange(newValue.length>0?newValue:undefined);};_this._onChange=function(item){var _assertThisInitialize10=(0,_assertThisInitialized2.default)(_this),_assertThisInitialize11=_assertThisInitialize10.props,onChange=_assertThisInitialize11.onChange,_assertThisInitialize12=_assertThisInitialize11.value,value=_assertThisInitialize12===void 0?[]:_assertThisInitialize12;if(!value.includes(item)){onChange([].concat((0,_toConsumableArray2.default)(value),[item]));_this.setState({inputValue:undefined,suggestions:[]});}};return _this;}(0,_createClass2.default)(InputList,[{key:"render",value:function render(){var _onInputSubmit=this._onInputSubmit,_onInputChange=this._onInputChange,_onSelectItem=this._onSelectItem,_onRemoveItem=this._onRemoveItem,_this$props=this.props,dataSource=_this$props.dataSource,dataSourceField=_this$props.dataSourceField,itemTemplate=_this$props.itemTemplate,onChange=_this$props.onChange,_this$props$value=_this$props.value,value=_this$props$value===void 0?[]:_this$props$value,inherit=(0,_objectWithoutProperties2.default)(_this$props,["dataSource","dataSourceField","itemTemplate","onChange","value"]),_this$state=this.state,inputValue=_this$state.inputValue,_this$state$suggestio=_this$state.suggestions,suggestions=_this$state$suggestio===void 0?[]:_this$state$suggestio;var disabled=inherit.disabled,error=inherit.error;var objDataSource=dataSource&&typeof dataSource[0]==='object';return _react.default.createElement(_reactNative.View,{style:[_InputList.default.container,inherit.style],__source:{fileName:_jsxFileName,lineNumber:100}},_react.default.createElement(_Input.default,(0,_extends2.default)({},inherit,{onChange:_onInputChange,onSubmitEditing:_onInputSubmit,style:_InputList.default.input,value:inputValue,__source:{fileName:_jsxFileName,lineNumber:101}})),suggestions.length>0&&_react.default.createElement(_reactNative.View,{style:[_InputList.default.content,_InputList.default.suggestions],__source:{fileName:_jsxFileName,lineNumber:110}},suggestions.map(function(item){return _react.default.createElement(_Touchable.default,{key:objDataSource?item[dataSourceField]:item,onPress:function onPress(){return _onSelectItem(item);},style:_InputList.default.suggestion,__source:{fileName:_jsxFileName,lineNumber:112}},_react.default.createElement(_ItemList.default,{template:itemTemplate,value:item,__source:{fileName:_jsxFileName,lineNumber:117}}));})),value.length>0&&_react.default.createElement(_reactNative.View,{style:[_InputList.default.content,_InputList.default.values,!disabled&&error&&_InputList.default.error,disabled&&_InputList.default.disabled],__source:{fileName:_jsxFileName,lineNumber:123}},value.map(function(item){var itemValue=objDataSource?dataSource.find(function(i){return i[dataSourceField]===item;}).title:item;return _react.default.createElement(_reactNative.View,{key:JSON.stringify(itemValue),pointerEvents:disabled?'none':undefined,style:_InputList.default.value,__source:{fileName:_jsxFileName,lineNumber:132}},_react.default.createElement(_ItemList.default,{template:itemTemplate,value:itemValue,__source:{fileName:_jsxFileName,lineNumber:137}}),_react.default.createElement(_Touchable.default,{onPress:function onPress(){return _onRemoveItem(item);},__source:{fileName:_jsxFileName,lineNumber:138}},_react.default.createElement(_Icon.default,{value:"close",style:_InputList.default.iconClose,__source:{fileName:_jsxFileName,lineNumber:139}})));})));}}]);return InputList;}(_react.PureComponent);InputList.propTypes={dataSource:(0,_propTypes.arrayOf)((0,_propTypes.oneOfType)([_propTypes.string,(0,_propTypes.shape)({})])),dataSourceField:_propTypes.string,disabled:_propTypes.bool,error:_propTypes.string,hint:_propTypes.string,itemTemplate:_propTypes.func,label:_propTypes.string,onChange:_propTypes.func,value:(0,_propTypes.arrayOf)((0,_propTypes.oneOfType)([_propTypes.string,(0,_propTypes.shape)({})]))};InputList.defaultProps={dataSource:undefined,dataSourceField:undefined,disabled:false,error:undefined,hint:undefined,itemTemplate:undefined,label:undefined,onChange:function onChange(){},value:undefined};var _default=InputList;exports.default=_default;